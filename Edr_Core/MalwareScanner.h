#pragma once
#include <windows.h>
#include <string>
#include <vector>
#include <mutex> 

class MalwareScanner {
public:
    MalwareScanner();
    ~MalwareScanner();

    // 掃描檔案 (支援 Device Path)
    bool ScanFile(const std::wstring& filePath);

    // [新增] 掃描記憶體 (針對加殼 Malware)
    bool ScanProcessMemory(DWORD pid);

private:
    void* m_scanner; // 使用 void* 避免 header 依賴太深，cpp 裡再轉型
    void* m_rules;
    std::mutex m_scanMutex; // [新增] 保護 YARA Scanner 的執行緒安全
};